<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BGB Token Mining</title>
  <style>
    body { background:#111; color:#eee; font-family:Arial; margin:0; text-align:center; }
    h1 { color:orange; margin:20px 0; }
    .topbar { margin:15px; }
    .btn { display:inline-block; background:red; color:#fff; padding:10px 20px; margin:5px;
           border-radius:8px; cursor:pointer; font-weight:bold; }
    .btn:hover { background:#b00; }
    .panel { background:#1c1c1c; border-radius:12px; padding:15px; width:70%; margin:20px auto; text-align:left; }
    #log { background:#000; color:#ccc; height:250px; overflow-y:auto; padding:10px; border-radius:8px; font-size:12px; }
    .green { color:#0f0; }
    .white { color:#fff; }
    #accrued { font-size:18px; font-weight:bold; margin:10px 0; }
    #status { font-weight:bold; margin:10px 0; }
  </style>
</head>
<body>

  <h1>BGB Token</h1>
  <p>⛏ Майнинг токенов прямо в браузере — 1 блок = 1 BGB. Минимум 300 BGB для выплаты.</p>

  <div class="panel">
    <h2>BGB Mining</h2>
    <div id="wallet">Wallet: —</div>
    <div id="hashrate">Hashrate: —</div>
    <div id="height">Height: 0</div>
    <div id="difficulty">Difficulty: 0x1f00ffff</div>
    <div id="target">Target: —</div>
    <div id="miners">Active miners: 1</div>
    <div id="accrued">Accrued: 0.0000 BGB</div>
    <div id="status">Status: ready</div>
    <div id="log"></div>

    <div style="margin-top:15px;">
      <span class="btn" onclick="connect()">Connect</span>
      <span class="btn" onclick="start()">Start</span>
      <span class="btn" onclick="stop()">Stop</span>
      <span class="btn" onclick="requestPayout()">Request Payout (≥300 BGB)</span>
    </div>
  </div>

  <script>
    let mining = false;
    let S = {
      wallet: "0x" + Math.random().toString(16).substring(2,10) + "...",
      height: 0,
      accrued: 0,
      difficulty: 0x1f00ffff,
      target: BigInt("0x0000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),
    };

    // загружаем сохранённое
    if(localStorage.getItem("accrued")){
      S.accrued = parseFloat(localStorage.getItem("accrued"));
      updateAccrued();
    }
    if(localStorage.getItem("height")){
      S.height = parseInt(localStorage.getItem("height"));
      document.getElementById("height").innerText = "Height: " + S.height;
    }

    function log(msg, cls="white"){
      let div=document.getElementById("log");
      let line=document.createElement("div");
      line.className=cls;
      line.innerText=msg;
      div.appendChild(line);
      div.scrollTop=div.scrollHeight;
    }

    function connect(){
      document.getElementById("wallet").innerText = "Wallet: " + S.wallet;
      document.getElementById("status").innerText = "Status: connected";
    }

    function start(){
      if(mining) return;
      mining = true;
      document.getElementById("status").innerText = "Status: mining...";
      mine();
    }

    function stop(){
      mining = false;
      document.getElementById("status").innerText = "Status: stopped";
    }

    function mine(){
      if(!mining) return;
      let nonce = Math.floor(Math.random()*1e9);
      let salt = Date.now().toString(16) + Math.random().toString(16).substring(2,10);
      let h = "0x" + btoa(nonce+salt).substring(0,64); // псевдохэш для имитации

      if(BigInt("0x"+nonce.toString(16)) < S.target){
        S.height++;
        S.accrued++;
        localStorage.setItem("accrued", S.accrued);
        localStorage.setItem("height", S.height);
        log("✔ Accepted block #" + S.height + " — " + h, "green");
        updateAccrued();

        // усложнение каждые 20 блоков
        if(S.height % 20 === 0){
          S.target = S.target >> 1n;
          S.difficulty += 1;
          document.getElementById("difficulty").innerText = "Difficulty: 0x" + S.difficulty.toString(16);
        }
        document.getElementById("height").innerText = "Height: " + S.height;
      } else {
        log("Hash tried: " + h, "white");
      }
      setTimeout(mine, 200);
    }

    function updateAccrued(){
      document.getElementById("accrued").innerText = "Accrued: " + S.accrued.toFixed(4) + " BGB";
    }

    function requestPayout(){
      if(S.accrued < 300){
        alert("Нужно минимум 300 BGB для запроса выплаты!");
        return;
      }
      let payload = {
        address: S.wallet,
        amount: S.accrued,
        height: S.height,
        message: "BGB Claim Request"
      };
      alert("Скопируйте это сообщение и отправьте администратору в Telegram:\n\n" + JSON.stringify(payload,null,2));
    }
  </script>
</body>
</html>
